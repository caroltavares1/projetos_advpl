/*SELECT
    SA1.A1_COD AS CODIGO,
    SA1.A1_LOJA AS LOJA,
    SE1.E1_PREFIXO,
    SE1.E1_NUM,
    SE1.E1_PARCELA,
    SE1.E1_TIPO,
    SE1.E1_EMISSAO,
    SE1.E1_VENCREA,
    SE1.E1_VALOR
FROM
    SA1990 SA1
    INNER JOIN SE1990 SE1 ON A1_LOJA = E1_LOJA
    AND A1_COD = E1_CLIENTE */

/*SELECT X1_GRUPO, X1_PERGUNT, X1_VAR01 FROM SX1990 WHERE X1_GRUPO = 'FINR460A'*/

/*SELECT 
    SE2.E2_TIPO,
    SE2.E2_PARCELA,
    SE2.E2_NUM,
    SE2.E2_EMISSAO,
    SE2.E2_FORNECE,
    SE2.E2_NOMFOR,    
    SE2.E2_VALOR,
    SE2.E2_XALLOWA,
    SZR.ZR_DESCR
FROM    
    SE2990 SE2,
    SZR990 SZR
WHERE
    SE2.E2_XALLOWA = SZR.ZR_CODIGO
    SE2.E2_ORIGEM = 'FINA050' */

SELECT 
    SD1.D1_TIPO,
    SD1.D1_SERIE,
    SD1.D1_DOC,
    SD1.D1_DTDIGIT,
    SD1.D1_FORNECE,
    SA2.A2_NOME,
    SF1.F1_VALBRUT,
    SD1.D1_XALLOWA,
    SZR.ZR_DESCR
FROM 
    SD1990 SD1,
    SA2990 SA2,
    SF1990 SF1,
    SZR990 SZR
WHERE
    SD1.D1_FORNECE = SA2.A2_COD AND
    SD1.D1_LOJA = SD1.D1_LOJA AND
    SD1.D1_DOC = SF1.F1_DOC AND
    SD1.D1_SERIE = SF1.F1_SERIE AND
    SD1.D1_FORNECE = SF1.F1_FORNECE AND
    SD1.D1_LOJA = SF1.F1_LOJA AND
    SD1.D1_XALLOWA = SZR.ZR_CODIGO


SELECT
    'PAGAMENTOS' AS ORIGEM, 
    SE5.E5_TIPO,
    SE5.E5_PARCELA,
    SE5.E5_NUMERO,
    SE5.E5_DTDIGIT,
    SE5.E5_CLIFOR,
    SE5.E5_BENEF,
    SE5.E5_VALOR,
    SE5.E5_VLJUROS,
    SE5.E5_VLDESCO,
    SE2.E2_XALLOWA,
    SZR.ZR_DESCR
FROM
    SE5990 SE5,
    SE2990 SE2,
    SZR990 SZR
WHERE
    SE5.E5_RECPAG = 'P' AND
    SE5.E5_PREFIXO = SE2.E2_PREFIXO AND
    SE5.E5_NUMERO = SE2.E2_NUM AND
    SE5.E5_PARCELA = SE2.E2_PARCELA AND 
    SE5.E5_TIPO = SE2.E2_TIPO AND
    SE5.E5_FORNECE = SE2.E2_FORNECE AND 
    SE5.E5_LOJA = SE2.E2_LOJA AND
    SE2.E2_XALLOWA = SZR.ZR_CODIGO


SELECT 
    'FINANCEIRO' AS ORIGEM,
    SE2.E2_TIPO AS TIPO,
    SE2.E2_PARCELA AS PARCELA,
    SE2.E2_NUM AS TITULO,
    SE2.E2_EMISSAO AS DTDIGIT,
    SE2.E2_FORNECE AS FORNECEDOR,
    SE2.E2_NOMFOR AS NOMFORNE,    
    SE2.E2_VALOR AS VALOR,
    SE2.E2_XALLOWA AS ALLOWANCE,
    SZR.ZR_DESCR AS DESCRICAO
FROM    
    SE2990 SE2,
    SZR990 SZR
WHERE
    SE2.E2_XALLOWA = SZR.ZR_CODIGO AND
    SE2.E2_ORIGEM = 'FINA050'

UNION

SELECT 
    'ESTOQUE/CUSTOS' AS ORIGEM,
    SD1.D1_TIPO AS TIPO,
    SD1.D1_SERIE AS PARCELA,
    SD1.D1_DOC AS TITULO,
    SD1.D1_DTDIGIT AS DTDIGIT,
    SD1.D1_FORNECE AS FORNECEDOR,
    SA2.A2_NOME AS NOMEFORNE,
    SF1.F1_VALBRUT AS VALOR,
    SD1.D1_XALLOWA AS ALLOWANCE,
    SZR.ZR_DESCR AS DESCRICAO
FROM 
    SD1990 SD1,
    SA2990 SA2,
    SF1990 SF1,
    SZR990 SZR
WHERE
    SD1.D1_FORNECE = SA2.A2_COD AND
    SD1.D1_LOJA = SD1.D1_LOJA AND
    SD1.D1_DOC = SF1.F1_DOC AND
    SD1.D1_SERIE = SF1.F1_SERIE AND
    SD1.D1_FORNECE = SF1.F1_FORNECE AND
    SD1.D1_LOJA = SF1.F1_LOJA AND
    SD1.D1_XALLOWA = SZR.ZR_CODIGO